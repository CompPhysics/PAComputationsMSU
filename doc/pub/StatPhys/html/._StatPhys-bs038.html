<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Statistical physics and the Ising Model">

<title>Statistical physics and the Ising Model</title>

<!-- Bootstrap style: bootstrap -->
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>


<script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
<script src="http://sagecell.sagemath.org/embedded_sagecell.js"></script>
<link rel="stylesheet" type="text/css" href="https://sagecell.sagemath.org/static/sagecell_embed.css">
<script>
$(function () {
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: 'Evaluate'});
});
</script>

</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Ensembles', 2, None, '___sec0'),
              ('Famous Ensembles', 2, None, '___sec1'),
              ('Canonical Ensemble', 2, None, '___sec2'),
              ('The partition function is a normalization constant',
               2,
               None,
               '___sec3'),
              ('Helmoltz free energy, what does it mean?',
               2,
               None,
               '___sec4'),
              ('Thermodynamical quantities', 2, None, '___sec5'),
              ('Thermodynamical quantities, the energy in the canonical ensemble',
               2,
               None,
               '___sec6'),
              ('Energy and specific heat in the canonical ensemble',
               2,
               None,
               '___sec7'),
              ('Magnetic moments and susceptibility in the canonical ensemble',
               2,
               None,
               '___sec8'),
              ('Our model, the Ising model in one and two dimensions',
               2,
               None,
               '___sec9'),
              ('Boltzmann distribution', 2, None, '___sec10'),
              ('Energy for a specific configuration', 2, None, '___sec11'),
              ('Configurations', 2, None, '___sec12'),
              ('Boundary conditions, free ends', 2, None, '___sec13'),
              ('Free ends and the energy', 2, None, '___sec14'),
              ('Free ends and energy', 2, None, '___sec15'),
              ('Periodic boundary conditions', 2, None, '___sec16'),
              ('Energy with PBC', 2, None, '___sec17'),
              ('Simple code for PBC', 2, None, '___sec18'),
              ('Summing up', 2, None, '___sec19'),
              ('Reorganizing', 2, None, '___sec20'),
              ('Our model, the Ising model in one and two dimensions',
               2,
               None,
               '___sec21'),
              ('Ising model in one and two dimensions', 2, None, '___sec22'),
              ('List of configurations with energies and magnetic moment',
               2,
               None,
               '___sec23'),
              ('Phase Transitions and Critical Phenomena',
               2,
               None,
               '___sec24'),
              ('Phase Transitions and Critical Phenomena, correlation length',
               2,
               None,
               '___sec25'),
              ('Classification of phase transitions', 2, None, '___sec26'),
              ('Second-order phase Transitions', 2, None, '___sec27'),
              ('Phase Transitions and Critical Phenomena',
               2,
               None,
               '___sec28'),
              ('Eherenfest definition of phase Transitions',
               2,
               None,
               '___sec29'),
              ('Phase Transitions and Critical Phenomena',
               2,
               None,
               '___sec30'),
              ('The Ising Model and Phase Transitions', 2, None, '___sec31'),
              ('The Metropolis Algorithm and the Two-dimensional Ising Model',
               2,
               None,
               '___sec32'),
              ('The Metropolis Algorithm and the Two-dimensional Ising Model',
               2,
               None,
               '___sec33'),
              ('The Metropolis Algorithm and the Two-dimensional Ising Model, practical issues',
               2,
               None,
               '___sec34'),
              ('Five possible energy differences', 2, None, '___sec35'),
              ('Two-dimensional Ising Model, energy per spin and specific heat',
               2,
               None,
               '___sec36'),
              ('Two-dimensional Ising Model and analysis of spin values',
               2,
               None,
               '___sec37')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="StatPhys-bs.html">Statistical physics and the Ising Model</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._StatPhys-bs001.html#___sec0" style="font-size: 80%;">Ensembles</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs002.html#___sec1" style="font-size: 80%;">Famous Ensembles</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs003.html#___sec2" style="font-size: 80%;">Canonical Ensemble</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs004.html#___sec3" style="font-size: 80%;">The partition function is a normalization constant</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs005.html#___sec4" style="font-size: 80%;">Helmoltz free energy, what does it mean?</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs006.html#___sec5" style="font-size: 80%;">Thermodynamical quantities</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs007.html#___sec6" style="font-size: 80%;">Thermodynamical quantities, the energy in the canonical ensemble</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs008.html#___sec7" style="font-size: 80%;">Energy and specific heat in the canonical ensemble</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs009.html#___sec8" style="font-size: 80%;">Magnetic moments and susceptibility in the canonical ensemble</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs010.html#___sec9" style="font-size: 80%;">Our model, the Ising model in one and two dimensions</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs011.html#___sec10" style="font-size: 80%;">Boltzmann distribution</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs012.html#___sec11" style="font-size: 80%;">Energy for a specific configuration</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs013.html#___sec12" style="font-size: 80%;">Configurations</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs014.html#___sec13" style="font-size: 80%;">Boundary conditions, free ends</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs015.html#___sec14" style="font-size: 80%;">Free ends and the energy</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs016.html#___sec15" style="font-size: 80%;">Free ends and energy</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs017.html#___sec16" style="font-size: 80%;">Periodic boundary conditions</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs018.html#___sec17" style="font-size: 80%;">Energy with PBC</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs019.html#___sec18" style="font-size: 80%;">Simple code for PBC</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs020.html#___sec19" style="font-size: 80%;">Summing up</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs021.html#___sec20" style="font-size: 80%;">Reorganizing</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs022.html#___sec21" style="font-size: 80%;">Our model, the Ising model in one and two dimensions</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs023.html#___sec22" style="font-size: 80%;">Ising model in one and two dimensions</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs024.html#___sec23" style="font-size: 80%;">List of configurations with energies and magnetic moment</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs025.html#___sec24" style="font-size: 80%;">Phase Transitions and Critical Phenomena</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs026.html#___sec25" style="font-size: 80%;">Phase Transitions and Critical Phenomena, correlation length</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs027.html#___sec26" style="font-size: 80%;">Classification of phase transitions</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs028.html#___sec27" style="font-size: 80%;">Second-order phase Transitions</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs029.html#___sec28" style="font-size: 80%;">Phase Transitions and Critical Phenomena</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs030.html#___sec29" style="font-size: 80%;">Eherenfest definition of phase Transitions</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs031.html#___sec30" style="font-size: 80%;">Phase Transitions and Critical Phenomena</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs032.html#___sec31" style="font-size: 80%;">The Ising Model and Phase Transitions</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs033.html#___sec32" style="font-size: 80%;">The Metropolis Algorithm and the Two-dimensional Ising Model</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs034.html#___sec33" style="font-size: 80%;">The Metropolis Algorithm and the Two-dimensional Ising Model</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs035.html#___sec34" style="font-size: 80%;">The Metropolis Algorithm and the Two-dimensional Ising Model, practical issues</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs036.html#___sec35" style="font-size: 80%;">Five possible energy differences</a></li>
     <!-- navigation toc: --> <li><a href="._StatPhys-bs037.html#___sec36" style="font-size: 80%;">Two-dimensional Ising Model, energy per spin and specific heat</a></li>
     <!-- navigation toc: --> <li><a href="#___sec37" style="font-size: 80%;">Two-dimensional Ising Model and analysis of spin values</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0038"></a>
<!-- !split -->

<h2 id="___sec37" class="anchor">Two-dimensional Ising Model and analysis of spin values </h2>

<p>
The following python code displays the values of the spins as function of temperature.
The blue color corresponds to spin up states while red represents spin down states. Increasing the temperature as input parameter, see the parameters below, results in a a net magnetization which becomes zero. At low temperatures, the system is highly ordered with essentially only one specific spin value.
<p>


<div class="compute"><script type="text/x-sage">
# coding=utf-8
#2-dimensional ising model with visualization

import numpy, sys, math
import pygame

#Needed for visualize when using SDL
screen = None;
font   = None;
BLOCKSIZE = 10

def periodic (i, limit, add):
    """
    Choose correct matrix index with periodic
    boundary conditions

    Input:
    - i:     Base index
    - limit: Highest \"legal\" index
    - add:   Number to add or subtract from i
    """
    return (i+limit+add) % limit

def visualize(spin_matrix, temp, E, M, method):
    """
    Visualize the spin matrix

    Methods:
    method = -1:No visualization (testing)
    method = 0: Just print it to the terminal
    method = 1: Pretty-print to terminal
    method = 2: SDL/pygame single-pixel
    method = 3: SDL/pygame rectangle
    """

    #Simple terminal dump
    if method == 0:
        print "temp:", temp, "E:", E, "M:", M
        print spin_matrix
    #Pretty-print to terminal
    elif method == 1:
        out = ""
        size = len(spin_matrix)
        for y in xrange(size):
            for x in xrange(size):
                if spin_matrix.item(x,y) == 1:
                    out += "X"
                else:
                    out += " "
            out += "\n"
        print "temp:", temp, "E:", E, "M:", M
        print out + "\n"
    #SDL single-pixel (useful for large arrays)
    elif method == 2:
        size = len(spin_matrix)
        screen.lock()
        for y in xrange(size):
            for x in xrange(size):
                if spin_matrix.item(x,y) == 1:
                    screen.set_at((x,y),(0,0,255))
                else:
                    screen.set_at((x,y),(255,0,0))
        screen.unlock()
        pygame.display.flip()
    #SDL block (usefull for smaller arrays)
    elif method == 3:
        size = len(spin_matrix)
        screen.lock()
        for y in xrange(size):
            for x in xrange(size):
                if spin_matrix.item(x,y) == 1:
                    rect = pygame.Rect(x*BLOCKSIZE,y*BLOCKSIZE,BLOCKSIZE,BLOCKSIZE)
                    pygame.draw.rect(screen,(0,0,255),rect)
                else:
                    rect = pygame.Rect(x*BLOCKSIZE,y*BLOCKSIZE,BLOCKSIZE,BLOCKSIZE)
                    pygame.draw.rect(screen,(255,0,0),rect)
        screen.unlock()
        pygame.display.flip()
    #SDL block w/ data-display
    elif method == 4:
        size = len(spin_matrix)
        screen.lock()
        for y in xrange(size):
            for x in xrange(size):
                if spin_matrix.item(x,y) == 1:
                    rect = pygame.Rect(x*BLOCKSIZE,y*BLOCKSIZE,BLOCKSIZE,BLOCKSIZE)
                    pygame.draw.rect(screen,(255,255,255),rect)
                else:
                    rect = pygame.Rect(x*BLOCKSIZE,y*BLOCKSIZE,BLOCKSIZE,BLOCKSIZE)
                    pygame.draw.rect(screen,(0,0,0),rect)
        s = font.render("<E> = %5.3E; <M> = %5.3E" % E,M,False,(255,0,0))
        screen.blit(s,(0,0))
        
        screen.unlock()
        pygame.display.flip()    

    

def monteCarlo(temp, size, trials, visual_method):
    """
    Calculate the energy and magnetization
    (\"straight\" and squared) for a given temperature

    Input:
    - temp:   Temperature to calculate for
    - size:   dimension of square matrix
    - trials: Monte-carlo trials (how many times do we
                                  flip the matrix?)
    - visual_method: What method should we use to visualize?

    Output:
    - E_av:       Energy of matrix averaged over trials, normalized to spins**2
    - E_variance: Variance of energy, same normalization * temp**2
    - M_av:       Magnetic field of matrix, averaged over trials, normalized to spins**2
    - M_variance: Variance of magnetic field, same normalization * temp
    - Mabs:       Absolute value of magnetic field, averaged over trials
    """

    #Setup spin matrix, initialize to ground state
    spin_matrix = numpy.zeros( (size,size), numpy.int8) + 1

    #Create and initialize variables
    E    = M     = 0
    E_av = E2_av = M_av = M2_av = Mabs_av = 0
    
    #Setup array for possible energy changes
    w = numpy.zeros(17,numpy.float64)
    for de in xrange(-8,9,4): #include +8
        w[de+8] = math.exp(-de/temp)
    
    #Calculate initial magnetization:
    M = spin_matrix.sum()
    #Calculate initial energy
    for j in xrange(size): 
        for i in xrange(size):
            E -= spin_matrix.item(i,j)*\
                 (spin_matrix.item(periodic(i,size,-1),j) + spin_matrix.item(i,periodic(j,size,1)))

    #Start metropolis MonteCarlo computation 
    for i in xrange(trials):
        #Metropolis
        #Loop over all spins, pick a random spin each time
        for s in xrange(size**2):
            x = int(numpy.random.random()*size)
            y = int(numpy.random.random()*size)
            deltaE = 2*spin_matrix.item(x,y)*\
                     (spin_matrix.item(periodic(x,size,-1), y) +\
                      spin_matrix.item(periodic(x,size,1),  y) +\
                      spin_matrix.item(x, periodic(y,size,-1)) +\
                      spin_matrix.item(x, periodic(y,size,1)))
            if numpy.random.random() <= w[deltaE+8]:
                #Accept!
                spin_matrix[x,y] *= -1
                M += 2*spin_matrix[x,y]
                E += deltaE
            
        #Update expectation values
        E_av    += E
        E2_av   += E**2
        M_av    += M
        M2_av   += M**2
        Mabs_av += int(math.fabs(M))

        visualize(spin_matrix, temp,E/float(size**2),M/float(size**2), method);

    #Normalize average values
    E_av       /= float(trials);
    E2_av      /= float(trials);
    M_av       /= float(trials);
    M2_av      /= float(trials);
    Mabs_av    /= float(trials);
    #Calculate variance and normalize to per-point and temp
    E_variance  = (E2_av-E_av*E_av)/float(size*size*temp*temp);
    M_variance  = (M2_av-M_av*M_av)/float(size*size*temp);
    #Normalize returned averages to per-point
    E_av       /= float(size*size);
    M_av       /= float(size*size);
    Mabs_av    /= float(size*size);
    
    return (E_av, E_variance, M_av, M_variance, Mabs_av)
    
    
# Main program

size        =   100
trials      =   100000
temp        = 2.1
method      =   3

#Initialize pygame
if method == 2 or method == 3 or method == 4:
    pygame.init()
    if method == 2:
        screen = pygame.display.set_mode((size,size))
    elif method == 3:
        screen = pygame.display.set_mode((size*10,size*10))
    elif method == 4:
        screen = pygame.display.set_mode((size*10,size*10))
        font   = pygame.font.Font(None,12)
        

(E_av, E_variance, M_av, M_variance, Mabs_av) = monteCarlo(temp,size,trials, method)
print "%15.8E %15.8E %15.8E %15.8E %15.8E %15.8E\n" % (temp, E_av, E_variance, M_av, M_variance, Mabs_av)

pygame.quit();


</script></div>
<p>

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._StatPhys-bs037.html">&laquo;</a></li>
  <li><a href="._StatPhys-bs000.html">1</a></li>
  <li><a href="">...</a></li>
  <li><a href="._StatPhys-bs030.html">31</a></li>
  <li><a href="._StatPhys-bs031.html">32</a></li>
  <li><a href="._StatPhys-bs032.html">33</a></li>
  <li><a href="._StatPhys-bs033.html">34</a></li>
  <li><a href="._StatPhys-bs034.html">35</a></li>
  <li><a href="._StatPhys-bs035.html">36</a></li>
  <li><a href="._StatPhys-bs036.html">37</a></li>
  <li><a href="._StatPhys-bs037.html">38</a></li>
  <li class="active"><a href="._StatPhys-bs038.html">39</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright only on the titlepage -->
</center>


</body>
</html>
    

