<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Examples on how to integrate a computational perspective in physics courses">

<title>Examples on how to integrate a computational perspective in physics courses</title>


<style type="text/css">
/* bloodish style */

body {
  font-family: Helvetica, Verdana, Arial, Sans-serif;
  color: #404040;
  background: #ffffff;
}
h1 { font-size: 1.8em;  color: #8A0808; }
h2 { font-size: 1.6em;  color: #8A0808; }
h3 { font-size: 1.4em;  color: #8A0808; }
h4 { color: #8A0808; }
a { color: #8A0808; text-decoration:none; }
tt { font-family: "Courier New", Courier; }
/* pre style removed because it will interfer with pygments */
p { text-indent: 0px; }
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-style: normal; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #bababa;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #f8f8f8;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


<script src="https://sagecell.sagemath.org/static/jquery.min.js"></script>
<script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script>
<link rel="stylesheet" type="text/css" href="https://sagecell.sagemath.org/static/sagecell_embed.css">
<script>
$(function () {
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: 'Evaluate'});
});
</script>

</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Why Computing in Physics Courses', 2, None, '___sec0'),
              ('A large fraction of our students get jobs were computing is '
               'central',
               2,
               None,
               '___sec1'),
              ('Computing as a way to develop intuition about the scientific '
               'process',
               2,
               None,
               '___sec2'),
              ('Computing competence', 2, None, '___sec3'),
              ('Better understanding of the scientific method',
               2,
               None,
               '___sec4'),
              ('Started initiative at Michigan State University',
               2,
               None,
               '___sec5'),
              ('Started initiative at Michigan State University',
               2,
               None,
               '___sec6'),
              ('Implementation in Oslo: The "C(omputing '
               'in)S(cience)E(Education)":"http://www.mn.uio.no/ccse/english/people/index.html"  '
               'project (since 2003)',
               2,
               None,
               '___sec7'),
              ('Example of bachelor program, Physics and Astronomy (astro '
               'path), University of Oslo',
               2,
               None,
               '___sec8'),
              ('Example: Computations from day one', 2, None, '___sec9'),
              ('Example: Computations from day one', 2, None, '___sec10'),
              ('Other Examples', 2, None, '___sec11'),
              ('Typical implementation first semester of study',
               2,
               None,
               '___sec12'),
              ('Symbolic calculations and numerical calculations in one code',
               2,
               None,
               '___sec13'),
              ('Error analysis', 2, None, '___sec14'),
              ('Integrating numerical mathematics with calculus',
               2,
               None,
               '___sec15'),
              ('Additional benefits: A structured approach to solving problems',
               2,
               None,
               '___sec16'),
              ('Additional benefits: A structure approach to solving problems',
               2,
               None,
               '___sec17'),
              ('Learning outcomes three first semesters', 2, None, '___sec18'),
              ('Later courses', 2, None, '___sec19'),
              ('Coordination', 2, None, '___sec20'),
              ('Challenges...', 2, None, '___sec21'),
              ('Examples of simple algorithms, initial value problems and '
               'proper scaling of equations',
               2,
               None,
               '___sec22'),
              ('Mechanics and electromagnetism, initial value problems',
               2,
               None,
               '___sec23'),
              ('Mechanics and electromagnetism, initial value problems and now '
               'proper scaling',
               2,
               None,
               '___sec24'),
              ('Other examples of simple algorithms that can be reused in many '
               'courses, two-point boundary value problems and scaling',
               2,
               None,
               '___sec25'),
              ('A buckling beam, or a quantum mechanical particle in an '
               'infinite well',
               2,
               None,
               '___sec26'),
              ('Discretize and get the same type of problem',
               2,
               None,
               '___sec27'),
              ('Adding complexity, hydrogen-like atoms or other one-particle '
               'potentials',
               2,
               None,
               '___sec28'),
              ('A natural length scale comes out automagically when scaling',
               2,
               None,
               '___sec29'),
              ('The Python code', 2, None, '___sec30'),
              ('The power of numerical methods', 2, None, '___sec31'),
              ('Which aspects are important for a successful introduction of '
               'CSE?',
               2,
               None,
               '___sec32'),
              ('Summary', 2, None, '___sec33'),
              ('More links', 2, None, '___sec34')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- ------------------- main content ---------------------- -->



<center><h1>Examples on how to integrate a computational perspective in physics courses</h1></center>  <!-- document title -->

<p>
<!-- author(s): Morten Hjorth-Jensen -->

<center>
<b>Morten Hjorth-Jensen</b> 
</center>

<p>
<!-- institution -->

<center><b>Michigan State University, USA, and University of Oslo, Norway</b></center>
<br>
<p>
<center><h4>Jun 21, 2018</h4></center> <!-- date -->
<br>
<p>
<!-- !split  -->

<h2 id="___sec0">Why Computing in Physics Courses </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
<li> One of two jobs in the stem fields will in 2020 be within computing.</li>
<li> Demands on computing in research continue to grow.</li>
<li> How can we integrate computing in core Physics courses in a coordinated and coherent way?</li> 
<li> Computing competence represents a central element in scientific problem solving, from basic education and research to essentially almost all advanced problems in modern societies.</li> 
</ul>
</div>


<p>
<!-- !split  -->

<h2 id="___sec1">A large fraction of our students get jobs were computing is central  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Computational modeling and data analysis is core to a variety of non-academic career paths that are often pursued by physics students following the receipt of their Bachelor's degree.
</div>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
A 2012 AIP (American Institute of Physics) survey of 5,000 recent physics Bachelor&#8217;s degree recipients indicated that 50% chose to enter the workforce immediately after receiving their degree. 
Of these, roughly 75% go into STEM-related fields including engineering, software development, or information technology.
</div>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Depending on sub-field, 60-80% of physics degree-holders in industry regularly need to engage in computer programming, simulation and modeling tasks. 
Many respondents to the survey stressed the importance of computer skills, including programming, in increasing their marketability to potential employers.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec2">Computing as a way to develop intuition about the scientific process </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The use of computational modeling in the classroom setting provides students with insights that are complementary to those resulting from pencil-and-paper manipulation of equations.
</div>

<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Computing in core physics courses allows us to bring important elements of scientific methods at a much earlier stage in our students' education.
</div>


<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The ability to closely examine the behavior of systems that are too complex to be easily analytically tractable, or that have no analytic solutions (i.e., many systems of practical interest), helps to develop intuition that is unavailable to many students from analytic calculation.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec3">Computing competence </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<b>Computing means solving scientific problems using all possible tools</b>, including symbolic computing, computers and numerical algorithms, and analytical paper and pencil solutions .

<p>
<b>Computing is about developing an understanding of the scientific method</b> by enhancing algorithmic thinking when solving problems.

<p>
On the part of students, this competence involves being able to:

<ul>
<li> understand how algorithms are used to solve mathematical problems,</li>
<li> derive, verify, and implement algorithms,</li>
<li> understand what can go wrong with algorithms,</li>
<li> use these algorithms to construct reproducible scientific outcomes and to engage in science in ethical ways, and</li>
<li> think algorithmically for the purposes of gaining deeper insights about scientific problems.</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec4">Better understanding of the scientific method </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
All these elements are central for maturing and gaining a better understanding of the modern scientific process <em>per se</em>.

<p>
The power of the scientific method lies in identifying a given problem
as a special case of an abstract class of problems, identifying
general solution methods for this class of problems, and applying a
general method to the specific problem (applying means, in the case of
computing, calculations by pen and paper, symbolic computing, or
numerical computing by ready-made and/or self-written software). This
generic view on problems and methods is particularly important for
understanding how to apply available, generic software to solve a
particular problem.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec5">Started initiative at Michigan State University </h2>

<p>
There are several courses in Physics where numerical exercises and/or projects have been included.   
Examples are: PHY321 (Mechanics), PHY410 (Thermal Physics), PHY415 (Mathematical Methods in Physics), PHY481 (Electromagnetism I) and PHY482 (Electromagnetism II).

<p>
The programming course CMSE 201 is required in order to take PHY321. Our students have thus a good basis in scientific programming

<p>
We have proposed a focus on integrating computing in upper division physics courses including:

<ul>
<li> outline proposed learning outcomes relating to computational modeling and data analysis within the upper-division physics curriculum,</li>
<li> offer a concrete and realistic plan of action that will allow us to attain these learning outcomes for selected courses, and</li>
<li> provide a plan to assess the progress of our efforts.</li>   
</ul>

<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec6">Started initiative at Michigan State University </h2>

<p>
The proposed computational curriculum goals are to:

<ul>
<li> Integrate computational learning practices in PHY321 by Fall 2018 or Spring 2019</li>
<li> Gradually integrate the remaining core (also elective) courses (PHY410, PHY415, PHY451, PHY471, PHY481), keeping pace with the cohort of students on this initial schedule.</li>
<li> Develop resources to support faculty and ensure continuity over year-to-year transitions.</li>
<li> Maintain program vitality by systematically refreshing computational course material as our programs evolve.</li>
<li> The working group will continue to work on the above action items and will invite current (and future) instructors to serve as members of the working group for the specific courses.</li>
</ul>

<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec7">Implementation in Oslo: The <a href="http://www.mn.uio.no/ccse/english/people/index.html" target="_blank">C(omputing in)S(cience)E(Education)</a>  project (since 2003) </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>What we do.</b>
<p>

<ul>
<li> Coordinated use of computational exercises and numerical tools in most undergraduate courses.</li>
<li> Help update the scientific staff's competence on computational aspects and give support (scientific, pedagogical and financial)  to those who wish to revise  their courses in a computational direction.</li>
<li> Teachers get good summer students to aid in introducing computational exercises</li>
<li> Develop courses and exercise modules with a computational perspective, both for students and teachers. New textbooks!!</li> 
<li> Basic idea: mixture of mathematics, computation, informatics and topics from the physical sciences.</li>
</ul>

Interesting outcome: higher focus on teaching and pedagogical issues!!
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec8">Example of bachelor program, Physics and Astronomy (astro path), University of Oslo </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<br /><br /><center><p><img src="figures/astronomy.png" align="bottom" width=900></p></center><br /><br />
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec9">Example: Computations from day one </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Differentiation.</b>
<p>
Three courses the first semester:  MAT1100, MAT-INF1100 og INF1100.

<ul>
<li> Definition  of the derivative in  MAT1100 (Calculus and analysis)</li>
</ul>

$$
 f'(x)=\lim_{h \rightarrow 0}\frac{f(x+h)-f(x)}{h}.
$$


<ul>
<li> Algorithms to compute the derivative in MAT-INF1100  (Mathematical modelling with computing)</li>
</ul>

$$
 f'(x)= \frac{f(x+h)-f(x-h)}{2h}+O(h^2).
$$


<ul>
<li> Implementation in Python in INF1100</li>
</ul>

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">differentiate</span>(f, x, h<span style="color: #666666">=1E-5</span>):
     <span style="color: #008000; font-weight: bold">return</span> (f(x<span style="color: #666666">+</span>h) <span style="color: #666666">-</span> f(x<span style="color: #666666">-</span>h))<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>h)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec10">Example: Computations from day one </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Differentiation and comparison with symbolic expressions.</b>
<p>
Combined with the possibility of symbolic calculations with <em>Sympy</em>, Python offers an environment where students an\
d teachers alike can test many different aspects of mathematics and numerical mathematics, in addition to being abl\
e to verify and validate their codes. The following simple example shows how to extend the simple function for comp\
uting the numerical derivative with the possibility of obtaining the closed form or analytical expression
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">differentiate</span>(f, x, h<span style="color: #666666">=1E-5</span>, symbolic<span style="color: #666666">=</span><span style="color: #008000">False</span>):
    <span style="color: #008000; font-weight: bold">if</span> symbolic:
        <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sympy</span>
        <span style="color: #008000; font-weight: bold">return</span> sympy<span style="color: #666666">.</span>lambdify([x], sympy<span style="color: #666666">.</span>diff(f, x))
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">return</span> (f(x<span style="color: #666666">+</span>h) <span style="color: #666666">-</span> f(x<span style="color: #666666">-</span>h))<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>h)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec11">Other Examples </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Integration by Trapezoidal Rule.</b>
<p>

<ul>
<li> Definition of integration  in MAT1100 (Calculus and analysis).</li>
<li> The algorithm for computing the  integral vha the Trapezoidal rule for an interval \( x \in [a,b] \)</li>
</ul>

$$
  \int_a^b(f(x) dx \approx \frac{1}{2}\left [f(a)+2f(a+h)+\dots+2f(b-h)+f(b)\right]
$$


<ul>
<li> Taught   in MAT-INF1100  (Mathematical modelling)</li>
<li> The algorithm is then implemented in  INF1100 (programming course).</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec12">Typical implementation first semester of study </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Integration by Trapezoidal Rule.</b>
<p>

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> exp, log, sin
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">Trapez</span>(a,b,f,n):
   h <span style="color: #666666">=</span> (b<span style="color: #666666">-</span>a)<span style="color: #666666">/</span><span style="color: #008000">float</span>(n)
   s <span style="color: #666666">=</span> <span style="color: #666666">0</span>
   x <span style="color: #666666">=</span> a
   <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>,n,<span style="color: #666666">1</span>):
       x <span style="color: #666666">=</span> x<span style="color: #666666">+</span>h
       s <span style="color: #666666">=</span> s<span style="color: #666666">+</span> f(x)
   s <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>(f(a)<span style="color: #666666">+</span>f(b)) <span style="color: #666666">+</span>s
   <span style="color: #008000; font-weight: bold">return</span> h<span style="color: #666666">*</span>s

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f1</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> exp(<span style="color: #666666">-</span>x<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>log(<span style="color: #666666">1+</span>x<span style="color: #666666">*</span>sin(x))

a <span style="color: #666666">=</span> <span style="color: #666666">1</span>;  b <span style="color: #666666">=</span> <span style="color: #666666">3</span>; n <span style="color: #666666">=</span> <span style="color: #666666">1000</span>
result <span style="color: #666666">=</span> Trapez(a,b,f1,n)
<span style="color: #008000; font-weight: bold">print</span>(result)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec13">Symbolic calculations and numerical calculations in one code  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Python offers an  extremely versatile programming  environment, allowing for
the inclusion of analytical studies in a numerical program. Here we show an
example code with the <b>trapezoidal rule</b> using <b>SymPy</b> to evaluate an integral and compute the absolute error
with respect to the numerically evaluated one of the integral
\( \int_0^1 dx x^2 = 1/3 \):
<p>


<div class="compute"><script type="text/x-sage">
from math import *
from sympy import *
def Trapez(a,b,f,n):
   h = (b-a)/float(n)
   s = 0
   x = a
   for i in range(1,n,1):
       x = x+h
       s = s+ f(x)
   s = 0.5*(f(a)+f(b)) +s
   return h*s

#  function to compute pi
def function(x):
    return x*x

a = 0.0;  b = 1.0; n = 100
result = Trapez(a,b,function,n)
print("Trapezoidal rule=", result)
# define x as a symbol to be used by sympy
x = Symbol('x')
exact = integrate(function(x), (x, 0.0, 1.0))
print("Sympy integration=", exact)
# Find relative error
print("Relative error", abs((exact-result)/exact))

</script></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec14">Error analysis </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The following extended version of the trapezoidal rule allows you  to plot the relative error by comparing with the exact result. By increasing to \( 10^8 \) points one arrives at a region where numerical errors start to accumulate.
<p>


<div class="compute"><script type="text/x-sage">
from math import log10
import numpy as np
from sympy import Symbol, integrate
import matplotlib.pyplot as plt
# function for the trapezoidal rule
def Trapez(a,b,f,n):
   h = (b-a)/float(n)
   s = 0
   x = a
   for i in range(1,n,1):
       x = x+h
       s = s+ f(x)
   s = 0.5*(f(a)+f(b)) +s
   return h*s
#  function to compute pi
def function(x):
    return x*x
# define integration limits
a = 0.0;  b = 1.0;
# find result from sympy
# define x as a symbol to be used by sympy
x = Symbol('x')
exact = integrate(function(x), (x, a, b))
# set up the arrays for plotting the relative error
n = np.zeros(9); y = np.zeros(9);
# find the relative error as function of integration points
for i in range(1, 8, 1):
    npts = 10**i
    result = Trapez(a,b,function,npts)
    RelativeError = abs((exact-result)/exact)
    n[i] = log10(npts); y[i] = log10(RelativeError);
plt.plot(n,y, 'ro')
plt.xlabel('n')
plt.ylabel('Relative error')
plt.show()

</script></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec15">Integrating numerical mathematics with calculus </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The last example shows the potential of combining numerical algorithms with symbolic calculations, allowing thereby students and teachers to

<ul>
<li> Validate and verify  their  algorithms.</li> 
<li> Including concepts like unit testing, one has the possibility to test and validate several or all parts of the code.</li>
<li> Validation and verification are then included <em>naturally</em> and one can develop a better attitude to what is meant with an ethically sound scientific approach.</li>
<li> The above example allows the student to also test the mathematical error of the algorithm for the trapezoidal rule by changing the number of integration points. The students get trained from day one to think error analysis.</li> 
<li> With an Jupyter/Ipython notebook the students can keep exploring similar examples and turn them in as their own notebooks.</li> 
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec16">Additional benefits: A structured approach to solving problems </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
In this process we easily bake in

<ol>
  <li> How to structure a code in terms of functions</li>
  <li> How to make a module</li>
  <li> How to read input data flexibly from the command line</li>
  <li> How to create graphical/web user interfaces</li>
  <li> How to write unit tests (test functions or doctests)</li>
  <li> How to refactor code in terms of classes (instead of functions only)</li>
  <li> How to conduct and automate large-scale numerical experiments</li>
  <li> How to write scientific reports in various formats (LaTeX, HTML)</li>
</ol>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec17">Additional benefits: A structure approach to solving problems </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The conventions and techniques outlined here will save you a lot of time when you incrementally extend software over time from simpler to more complicated problems. In particular, you will benefit from many good habits:

<ol>
<li> New code is added in a modular fashion to a library (modules)</li>
<li> Programs are run through convenient user interfaces</li>
<li> It takes one quick command to let all your code undergo heavy testing</li> 
<li> Tedious manual work with running programs is automated,</li>
<li> Your scientific investigations are reproducible, scientific reports with top quality typesetting are produced both for paper and electronic devices.</li>
</ol>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec18">Learning outcomes three first semesters </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Knowledge of basic algorithms.</b>
<p>

<ul>
<li> Differential equations: Euler, modified Euler and Runge-Kutta methods (first semester)</li>
<li> Numerical integration: Trapezoidal and Simpson's rule, multidimensional integrals (first semester)</li>
<li> Random numbers, random walks, probability distributions and Monte Carlo integration  (first semester)</li>
<li> Linear Algebra and eigenvalue problems: Gaussian elimination, LU-decomposition, SVD, QR, Givens rotations and eigenvalues, Gauss-Seidel. (second and third semester)</li>
<li> Root finding and interpolation etc. (all three first semesters)</li>
<li> Processing of sound and images (first semester).</li>
</ul>

The students have to code several of these algorithms during the first three semesters.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec19">Later courses </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
<b>Later courses should build on this foundation as much as possible</b>.

<ol>
<li> In particular, the course should not be too basic! There should be progression in the use of mathematics, numerical methods and programming, as well as science.</li>
<li> Computational platform: Python, fully object-oriented and allows for seamless integration of c++ and Fortran codes, as well as Matlab-like programming environment. Makes it easy to parallelize codes as well.</li>
</ol>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec20">Coordination </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
<li> Teachers in other courses need therefore not use much time on numerical tools. Naturally included in other courses.</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec21">Challenges...  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>.. and objections.</b>
<p>

<p>
<em>Standard objection: computations take away the attention from other central topics in 'my course'</em>.

<p>
CSE incorporates computations from day one, and courses higher up do not need to
spend time on computational topics  (technicalities), but can focus on the interesting
science applications.  Coordination and synchronization across departments and courses. Increases collaboration on teaching and awareness of pedagical research.

<ul>
<li> To help teachers: Developed pedagogical modules which can aid university teachers. Own course for teachers.</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec22">Examples of simple algorithms, initial value problems and proper scaling of equations </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ol>
<li> Ordinary differential equations (ODE): RLC circuit</li>
<li> ODE: Classical pendulum</li>
<li> ODE: Solar system</li>
<li> and many more cases</li>
</ol>

Can use essentially the <b>same algorithms to solve these problems</b>, either some simple modified Euler algorithms or some Runge-Kutta class of algorithms or perhaps the so-called Verlet class of algorithms.  <b>Algorithms students use in one course can be reused in other courses</b>.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec23">Mechanics and electromagnetism, initial value problems  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>When properly scaled, these equations are essentially the same. Scaling is important.</b>
<p>

<p>
Classical pendulum with damping and external force as it could appear in a mechanics course.
$$
  ml\frac{d^2\theta}{dt^2}+\nu\frac{d\theta}{dt}  +mgsin(\theta)=Acos(\omega t).
$$

Easy to solve numerically and then visualize the solution.
Almost the same equation for an RLC circuit in the electromagnetism course,
$$
L\frac{d^2Q}{dt^2}+\frac{Q}{C}+R\frac{dQ}{dt}=Acos(\omega t).
$$


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec24">Mechanics and electromagnetism, initial value problems and now proper scaling  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
Classical pendulum equations with damping and external force
$$
   \frac{d\theta}{d\hat{t}} =\hat{v},
$$

and
$$
   \frac{d\hat{v}}{d\hat{t}} =Acos(\hat{\omega} \hat{t})-\hat{v}\xi-\sin(\theta),
$$

with \( \omega_0=\sqrt{g/l} \), \( \hat{t}=\omega_0 t \) and \( \xi = mg/\omega_0\nu \).

<p>
The RLC circuit
$$
   \frac{dQ}{d\hat{t}} =\hat{I},
$$

and
$$
   \frac{d\hat{I}}{d\hat{t}} =Acos(\hat{\omega} \hat{t})-\hat{I}\xi-Q,
$$

with \( \omega_0=1/\sqrt{LC} \), \( \hat{t}=\omega_0 t \) and \( \xi = CR\omega_0 \).

<p>
The equations are essentially the same. <b>Great potential for abstraction</b>. Use the same program with small modifications.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec25">Other examples of simple algorithms that can be reused in many courses, two-point boundary value problems and scaling </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
These physics examples can all be studied using almost the same types of algorithms, simple eigenvalue solvers or Gaussian elimination with <b>almost</b> the same starting matrix!

<ol>
<li> A buckling beam and tridiagonal Toeplitz matrices (mechanics and mathematical methods), eigenvalue problems</li>
<li> A particle in an infinite potential well, quantum eigenvalue problems</li>
<li> A particle (or two) in a general quantum well, quantum eigenvalue problems</li>
<li> Poisson's  equation in one dim, linear algebra (electromagnetism)</li>
<li> The diffusion equation in one dimension (Statistical Physics), linear algebra</li>
<li> and many other cases</li>
</ol>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec26">A buckling beam, or a quantum mechanical particle in an infinite well </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
This is a two-point boundary value problem
$$
R \frac{d^2 u(x)}{dx^2} = -F u(x),
$$

where \( u(x) \) is the vertical displacement, \( R \) is a material specific constant, \( F \) the force and \( x \in [0,L] \) with \( u(0)=u(L)=0 \).

<p>
Scale equations with \( x = \rho L \) and \( \rho \in [0,1] \) and get (note that we change from \( u(x) \) to \( v(\rho) \)) 
$$
\frac{d^2 v(\rho)}{dx^2} +K v(\rho)=0,
$$

a standard eigenvalue problem with \( K= FL^2/R \).

<p>
If you replace \( R=-\hbar^2/2m \) and \( -F=\lambda \), we have the quantum mechanical variant for a particle moving in a well with infinite walls at the endpoints.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec27">Discretize and get the same type of problem  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Discretize the second derivative and the rhs
$$
    -\frac{v_{i+1} -2v_i +v_{i-i}}{h^2}=\lambda v_i,
$$

with \( i=1,2,\dots, n \). We need to add to this system the two boundary conditions \( v(0) =v_0 \) and \( v(1) = v_{n+1} \).
The so-called Toeplitz matrix (special case from the discretized second derivative)
$$
    \mathbf{A} = \frac{1}{h^2}\begin{bmatrix}
                          2 & -1 &  &   &  & \\
                          -1 & 2 & -1 & & & \\
                           & -1 & 2 & -1 & &  \\
                           & \dots   & \dots &\dots   &\dots & \dots \\
                           &   &  &-1  &2& -1 \\
                           &    &  &   &-1 & 2 \\
                      \end{bmatrix}
$$

with the corresponding vectors \( \mathbf{v} = (v_1, v_2, \dots,v_n)^T \) allows us to rewrite the differential equation
including the boundary conditions as a standard eigenvalue problem
$$
   \mathbf{A}\mathbf{v} = \lambda\mathbf{v}.
$$

The Toeplitz matrix has analytical eigenpairs!! Adding a potential along the diagonals allows us to reuse this problem for many types of physics cases.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec28">Adding complexity, hydrogen-like atoms or other one-particle potentials  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Assume we want to solve the radial part of Schroedinger's equation for one particle in three dimensions. This equation reads
$$
  -\frac{\hbar^2}{2 m} \left ( \frac{1}{r^2} \frac{d}{dr} r^2
  \frac{d}{dr} - \frac{l (l + 1)}{r^2} \right )R(r)
     + V(r) R(r) = E R(r).
$$

Suppose in our  case \( V(r) \) is the harmonic oscillator potential \( (1/2)kr^2 \) with
\( k=m\omega^2 \) and \( E \) is
the energy of the harmonic oscillator in three dimensions.

<p>
Scale now the equations with \( \rho = r/\alpha \) where \( \alpha \) is a constant of dimension length.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec29">A natural length scale comes out automagically when scaling </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Manipulating the equations by requiring
$$
\frac{mk}{\hbar^2} \alpha^4 = 1,
$$

which define defines a natural length scale (like the Bohr radius does)
$$
\alpha = \left(\frac{\hbar^2}{mk}\right)^{1/4}.
$$

Defining
$$
\lambda = \frac{2m\alpha^2}{\hbar^2}E,
$$

we can rewrite Schroedinger's equation as
$$
  -\frac{d^2}{d\rho^2} v(\rho) + \rho^2v(\rho)  = \lambda v(\rho) .
$$

This is similar to the equation for a buckling beam except for the potential term.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec30">The Python code </h2>
The code sets up the Hamiltonian matrix by defining the minimun and maximum values of \( r \) with a
maximum value of integration points. It plots the
eigenfunctions of the three lowest eigenstates.
<p>


<div class="compute"><script type="text/x-sage">
#Program which solves the one-particle Schrodinger equation
#for a potential specified in function
#potential().

from  matplotlib import pyplot as plt
import numpy as np
#Function for initialization of parameters
def initialize():
    RMin = 0.0
    RMax = 10.0
    lOrbital = 0
    Dim = 400
    return RMin, RMax, lOrbital, Dim
# Harmonic oscillator here, easy to change
def potential(r):
    return 0.5*r*r

#Get the boundary, orbital momentum and number of integration points
RMin, RMax, lOrbital, Dim = initialize()

#Initialize constants
Step    = RMax/(Dim+1)
DiagConst = 1.0/ (Step*Step)
NondiagConst =  -0.5 / (Step*Step)
OrbitalFactor = 0.5*lOrbital * (lOrbital + 1.0)

#Calculate array of potential values
v = np.zeros(Dim)
r = np.linspace(RMin,RMax,Dim)
for i in range(Dim):
    r[i] = RMin + (i+1) * Step;
    v[i] = potential(r[i]) + OrbitalFactor/(r[i]*r[i]);

#Setting up a tridiagonal matrix and finding eigenvectors and eigenvalues
Matrix = np.zeros((Dim,Dim))
Matrix[0,0] = DiagConst + v[0];
Matrix[0,1] = NondiagConst;
for i in range(1,Dim-1):
    Matrix[i,i-1]  = NondiagConst;
    Matrix[i,i]    = DiagConst + v[i];
    Matrix[i,i+1]  = NondiagConst;
Matrix[Dim-1,Dim-2] = NondiagConst;
Matrix[Dim-1,Dim-1] = DiagConst + v[Dim-1];
# diagonalize and obtain eigenvalues, not necessarily sorted
EigValues, EigVectors = np.linalg.eig(Matrix)
# sort eigenvectors and eigenvalues
permute = EigValues.argsort()
EigValues = EigValues[permute]
EigVectors = EigVectors[:,permute]
# now plot the results for the three lowest lying eigenstates
for i in range(3):
    print(EigValues[i])
FirstEigvector = EigVectors[:,0]
SecondEigvector = EigVectors[:,1]
ThirdEigvector = EigVectors[:,2]
plt.plot(r, FirstEigvector**2 ,'b-',r, SecondEigvector**2 ,'g-',r, ThirdEigvector**2 ,'r-')
plt.axis([0,4.6,0.0, 0.025])
plt.xlabel(r'$r$')
plt.ylabel(r'Radial probability $r^2|R(r)|^2$')
plt.title(r'Radial probability distributions for three lowest-lying states')
plt.savefig('eigenvector.pdf')
plt.show()

</script></div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec31">The power of numerical methods </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The last example shows the potential of combining numerical algorithms with analytical results (or eventually symbolic calculations). 
A simple change of potential gives a new physics case, example of a box potential
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Different types of potentials</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">potential</span>(r):
    <span style="color: #008000; font-weight: bold">if</span> r <span style="color: #666666">&gt;=</span> <span style="color: #666666">0.0</span> <span style="color: #AA22FF; font-weight: bold">and</span> r <span style="color: #666666">&lt;=</span> <span style="color: #666666">10.0</span>:
        V <span style="color: #666666">=</span> <span style="color: #666666">-0.05</span>
    <span style="color: #008000; font-weight: bold">else</span>:
        V <span style="color: #666666">=0.0</span>
    <span style="color: #008000; font-weight: bold">return</span> V
</pre></div>
<p>
This allows students and teachers to

<ul>
<li> make abstraction and explore other physics cases easily where no analytical solutions are known</li>
<li> Validate and verify  their  algorithms.</li>
<li> Including concepts like unit testing, one has the possibility to test and validate several or all parts of the code.</li>
<li> Validation and verification are then included <em>naturally</em> and one can develop a better attitude to what is meant with an ethically sound scientific approach.</li>
<li> The above example allows the student to also test the mathematical error of the algorithm for the eigenvalue solver by changing the number of integration points. The students get trained from day one to think error analysis.</li>
<li> The algorithm can be tailored to any kind of one-particle problem used in quantum mechanics or eigenvalue problems</li>
<li> A simple rewrite allows for reuse in linear algebra problems for solution of say Poisson's equation in electromagnetism, or the diffusion equation in one dimension.</li>
<li> With an ipython notebook the students can keep exploring similar examples and turn them in as their own notebooks.</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec32">Which aspects are important for a successful introduction of CSE? </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
<li> Early introduction, programming course at beginning of studies linked with math courses and science and engineering courses.</li>
<li> Crucial to learn proper programming at the beginning.</li>
<li> Good TAs</li>
<li> Choice of software.</li>
<li> Textbooks and modularization of topics, ask for details</li>
<li> Resources and expenses.</li>
<li> Tailor to specific disciplines.</li>
<li> Organizational matters.</li>
<li> With a local  physics education group one can do much more!! At MSU we have a very strong <a href="http://create4stem.msu.edu/group/perl" target="_blank">Physics Education Research group headed by Danny Caballero and Washti Sawtelle</a></li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec33">Summary </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
<li> Make our research visible in early undergraduate courses, enhance research based teaching</li>
<li> Possibility to focus more on understanding and increased insight.</li>
<li> Impetus for broad cooperation in teaching. Broad focus on university pedagogical topics.</li>
<li> Strengthening of instruction based teaching (expensive and time-consuming).</li>
<li> Give our candidates a broader and more up-to-date education with a problem-based orientation, often requested by potential employers.</li>
<li> And perhaps the most important issue: does this enhance the student's insight in the Sciences?</li>
</ul>

We invite you to visit (online and/or in real life) our new center on <a href="http://www.mn.uio.no/ccse/english/" target="_blank">Computing in Science Education</a>


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec34">More links  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
<li> Python and our first programming course, first semester <a href="http://www.uio.no/studier/emner/matnat/ifi/INF1100/h14/" target="_blank">course</a>. Excellent new textbook by Hans Petter Langtangen, click here for the <a href="http://www.amazon.com/Scientific-Programming-Computational-Science-Engineering-ebook/dp/B00DGER1NQ/ref=sr_1_2?ie=UTF8&qid=1425382942&sr=8-2&keywords=langtangen" target="_blank">textbook</a> or the <a href="http://hplgit.github.io/primer.html/doc/web/index.html" target="_blank">online version</a></li>
<li> Mathematical modelling course, first semester <a href="http://www.uio.no/studier/emner/matnat/math/MAT-INF1100/h14/" target="_blank">course</a>. Textbook by Knut Morken to be published by Springer.</li>
<li> Mechanics, second semester <a href="http://www.uio.no/studier/emner/matnat/fys/FYS-MEK1100/v12/" target="_blank">course</a>. New textbook by Anders Malthe-Sorenssen, published by Springer, <a href="http://www.springer.com/us/book/9783319195957" target="_blank">Undergraduate Lecture Notes in Physics</a></li>
<li> Computational Physics I, fifth semester <a href="http://www.uio.no/studier/emner/matnat/fys/FYS3150/h15/" target="_blank">course</a>. Textbook to be published by IOP, with <a href="https://github.com/CompPhysics/ComputationalPhysics1" target="_blank">online version</a></li>
<li> Book on waves and motion, Statistical Physics and Quantum physics to come, stay tuned!!</li>
</ul>
</div>


<p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

